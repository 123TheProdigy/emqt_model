---
title: "Data Analysis and Game Theory"
output: html_notebook
---

```{r}
library(ggplot2)
library(dplyr)
library(stats)
```

### True value in set1, sim1

```{r}
TrueValue_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[1, 2])), ", ")[[1]]
#average <- mean(TrueValues_set1)
plot(TrueValue_set1, type = "l", pch = 16, col = "blue", main = "True Values in sim0", xlab = "Iteration", ylab = "Value")

#TrueValue_set1_sim0 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[1, 2])), ", ")[[1]]
#unlist(aggregated_results_1[1, 2])
#clean_str = gsub("\\[|\\]", "", TrueValue_sim0)
#TrueValue_set1_sim1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[2, 2])), ", ")[[1]]

#print(Values)
#X <- 1:100
#plot(TrueValue_set1_sim0, type = "l", pch = 16, col = "blue", main = "True Values in sim0", xlab = "Iteration", ylab = "Value")
#plot(TrueValue_set1_sim1, type = "l", pch = 16, col = "blue", main = "True Values in sim1", xlab = "Iteration", ylab = "Value")

#fit <- lm(Values ~ X)
#abline(fit, col = "red")
```
### True values in set 1, all sim

```{r}
# Initialize an empty vector to store the True values
TrueValues_set1 <- numeric()

# Loop through each iteration (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_1 dataframe
  TrueValue_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 2])), ", ")[[1]]
  
  # Append the True values to the vector
  TrueValues_set1 <- c(TrueValues_set1, as.numeric(TrueValue_set1))
}

# Calculate the average of True values
average <- mean(TrueValues_set1)

# Plot the average
plot(TrueValues_set1, type = "l", pch = 16, col = "blue", main = "True Values in set 1", xlab = "Iteration", ylab = "Value")

# Add a horizontal line for the average
abline(h = average, col = "red", lwd = 2)

```

### Expected value in set1, all sim

```{r}
# Initialize an empty vector to store the True values
ExpectedValues_set1 <- numeric()

# Loop through each iteration (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_1 dataframe
  ExpectedValue_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 3])), ", ")[[1]]
  
  # Append the True values to the vector
  ExpectedValues_set1 <- c(ExpectedValues_set1, as.numeric(ExpectedValue_set1))
}

# Calculate the average of True values
average <- mean(ExpectedValues_set1)

# Plot the average
plot(ExpectedValues_set1, type = "l", pch = 16, col = "blue", main = "Expected Values in set 1", xlab = "Iteration", ylab = "Value")

# Add a horizontal line for the average
abline(h = average, col = "red", lwd = 2)

```

### True and Expected Values in set 1

```{r}
# Initialize empty vectors to store true and expected values
TrueValues_set1 <- numeric()
ExpectedValues_set1 <- numeric()

# Loop through each iteration (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_1 dataframe
  TrueValue_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 2])), ", ")[[1]]
  
  # Extract Expected values from the aggregated_results_1 dataframe
  ExpectedValue_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 3])), ", ")[[1]]
  
  # Append the True and Expected values to their respective vectors
  TrueValues_set1 <- c(TrueValues_set1, as.numeric(TrueValue_set1))
  ExpectedValues_set1 <- c(ExpectedValues_set1, as.numeric(ExpectedValue_set1))
}

# Calculate the average of True values
average_true <- mean(TrueValues_set1)

# Calculate the average of Expected values
average_expected <- mean(ExpectedValues_set1)

# Plot True and Expected values on the same plot
plot(TrueValues_set1, type = "l", pch = 16, col = "blue", main = "True vs Expected Values in set 1", xlab = "Iteration", ylab = "Value")
lines(ExpectedValues_set1, type = "l", pch = 16, col = "red")

# Add legend
legend("topright", legend = c("True Values", "Expected Values"), col = c("blue", "red"), lty = 1, cex = 0.8)

# Add horizontal lines for the averages
abline(h = average_true, col = "blue", lwd = 1)
abline(h = average_expected, col = "red", lwd = 1)
```

### Bids in set1, sim1


```{r}
Bids_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[1, 4])), ", ")[[1]]
#average <- mean(TrueValues_set1)
plot(Bids_set1, type = "l", pch = 16, col = "blue", main = "True Values in sim0", xlab = "Iteration", ylab = "Value")
```

### Bids in set 1, all sim

```{r}
# Initialize an empty vector to store the True values
Bids_set1 <- numeric()

# Loop through each iteration (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_1 dataframe
  Bid_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 4])), ", ")[[1]]
  
  # Append the True values to the vector (corrected typo)
  Bids_set1 <- c(Bids_set1, as.numeric(Bid_set1))
}

# Check if the vector is properly populated
#print(Bids_set1)

# Calculate the average of True values
average <- mean(Bids_set1, na.rm = TRUE)

# Plot the values
plot(Bids_set1, type = "l", pch = 16, col = "blue", main = "Expected Values in set 1", xlab = "Iteration", ylab = "Value")

# Add a horizontal line for the average
abline(h = average, col = "red", lwd = 2)

```

### Bids and Asks Overall

```{r}
# Initialize empty vectors to store the Bid and Ask values
Bids_set1 <- numeric()
Asks_set1 <- numeric()

# Loop through each iteration (n)
for (n in 1:10) {
  # Extract Bid values from the aggregated_results_1 dataframe
  Bid_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 4])), ", ")[[1]]
  
  # Extract Ask values from the aggregated_results_1 dataframe (next column)
  Ask_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 5])), ", ")[[1]]
  
  # Append the Bid and Ask values to their respective vectors
  Bids_set1 <- c(Bids_set1, as.numeric(Bid_set1))
  Asks_set1 <- c(Asks_set1, as.numeric(Ask_set1))
}

# Calculate the average of Bid and Ask values
average_bids <- mean(Bids_set1, na.rm = TRUE)
average_asks <- mean(Asks_set1, na.rm = TRUE)

# Plot the Bid and Ask values on the same plot
plot(Bids_set1, type = "l", pch = 16, col = "blue", main = "Bids vs Asks in set 1", xlab = "Iteration", ylab = "Value")
lines(Asks_set1, type = "l", pch = 16, col = "red")

# Add legend
legend("topright", legend = c("Bids", "Asks"), col = c("blue", "red"), lty = 1, cex = 0.8)

# Add horizontal lines for the averages
abline(h = average_bids, col = "blue", lty = 1)
abline(h = average_asks, col = "red", lty = 1)

```

### Start From Here


## set 1 (6 informed)

```{r}
# Initialize matrices to store averages for each position
average_true <- matrix(NA, nrow = 100, ncol = 10)
average_expected <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  TrueValues_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 2])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  ExpectedValues_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 3])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    True_values <- sapply(TrueValues_set1, function(x) as.numeric(x[i]))
    Expected_values <- sapply(ExpectedValues_set1, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_true[i, n] <- mean(True_values, na.rm = TRUE)
    average_expected[i, n] <- mean(Expected_values, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_true <- rowMeans(average_true, na.rm = TRUE)
overall_average_expected <- rowMeans(average_expected, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_true, type = "l", pch = 16, col = "blue", main = "Overall Average of True vs Expected Values", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_true, overall_average_expected)), max(c(overall_average_true, overall_average_expected))))
lines(overall_average_expected, type = "l", pch = 16, col = "red")
legend("topright", legend = c("True Values", "Expected Values"), col = c("blue", "red"), lty = 1, cex = 0.8)
```

```{r}
# Initialize matrices to store averages for each position
average_bid <- matrix(NA, nrow = 100, ncol = 10)
average_ask <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  Bids_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 4])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  Asks_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 5])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    Bids <- sapply(Bids_set1, function(x) as.numeric(x[i]))
    Asks <- sapply(Asks_set1, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_bid[i, n] <- mean(Bids, na.rm = TRUE)
    average_ask[i, n] <- mean(Asks, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_bid <- rowMeans(average_bid, na.rm = TRUE)
overall_average_ask <- rowMeans(average_ask, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_bid, type = "l", pch = 16, col = "blue", main = "Overall Average of Bids vs Asks", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_bid, overall_average_ask)), max(c(overall_average_bid, overall_average_ask))))
lines(overall_average_ask, type = "l", pch = 16, col = "red")
legend("topright", legend = c("Bids", "Asks"), col = c("blue", "red"), lty = 1, cex = 0.8)
```


```{r}
# Initialize matrices to store averages for each position
average_MM_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed3_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed4_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed5_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed6_pnl <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pnl_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 6])), ", ")

  Informed1_pnl_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 8])), ", ")
  
  Informed2_pnl_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 10])), ", ")
  
  Informed3_pnl_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 12])), ", ")
  
  Informed4_pnl_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 14])), ", ")
  
  Informed5_pnl_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 16])), ", ")
  
  Informed6_pnl_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 18])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pnl <- sapply(MM_pnl_set1, function(x) as.numeric(x[i]))
    Informed1_pnl <- sapply(Informed1_pnl_set1, function(x) as.numeric(x[i]))
    Informed2_pnl <- sapply(Informed2_pnl_set1, function(x) as.numeric(x[i]))
    Informed3_pnl <- sapply(Informed3_pnl_set1, function(x) as.numeric(x[i]))
    Informed4_pnl <- sapply(Informed4_pnl_set1, function(x) as.numeric(x[i]))
    Informed5_pnl <- sapply(Informed5_pnl_set1, function(x) as.numeric(x[i]))
    Informed6_pnl <- sapply(Informed6_pnl_set1, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pnl[i, n] <- mean(MM_pnl, na.rm = TRUE)
    average_Informed1_pnl[i, n] <- mean(Informed1_pnl, na.rm = TRUE)
    average_Informed2_pnl[i, n] <- mean(Informed2_pnl, na.rm = TRUE)
    average_Informed3_pnl[i, n] <- mean(Informed3_pnl, na.rm = TRUE)
    average_Informed4_pnl[i, n] <- mean(Informed4_pnl, na.rm = TRUE)
    average_Informed5_pnl[i, n] <- mean(Informed5_pnl, na.rm = TRUE)
    average_Informed6_pnl[i, n] <- mean(Informed6_pnl, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pnl <- rowMeans(average_MM_pnl, na.rm = TRUE)
overall_average_Informed1_pnl <- rowMeans(average_Informed1_pnl, na.rm = TRUE)
overall_average_Informed2_pnl <- rowMeans(average_Informed2_pnl, na.rm = TRUE)
overall_average_Informed3_pnl <- rowMeans(average_Informed3_pnl, na.rm = TRUE)
overall_average_Informed4_pnl <- rowMeans(average_Informed4_pnl, na.rm = TRUE)
overall_average_Informed5_pnl <- rowMeans(average_Informed5_pnl, na.rm = TRUE)
overall_average_Informed6_pnl <- rowMeans(average_Informed6_pnl, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pnl, type = "l", pch = 16, col = "black", main = "Overall Average PNL", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pnl, overall_average_Informed1_pnl, overall_average_Informed2_pnl, overall_average_Informed3_pnl, overall_average_Informed4_pnl, overall_average_Informed5_pnl, overall_average_Informed6_pnl)), max(c(overall_average_MM_pnl, overall_average_Informed1_pnl, overall_average_Informed2_pnl, overall_average_Informed3_pnl, overall_average_Informed4_pnl, overall_average_Informed5_pnl, overall_average_Informed6_pnl))))
lines(overall_average_Informed1_pnl, type = "l", pch = 16, col = "red")
lines(overall_average_Informed2_pnl, type = "l", pch = 16, col = "green")
lines(overall_average_Informed3_pnl, type = "l", pch = 16, col = "yellow")
lines(overall_average_Informed4_pnl, type = "l", pch = 16, col = "blue")
lines(overall_average_Informed5_pnl, type = "l", pch = 16, col = "purple")
lines(overall_average_Informed6_pnl, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed 1", "Informed 2", "Informed 3", "Informed 4", "Informed 5", "Informed 6"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```

```{r}
# Initialize matrices to store averages for each position
average_MM_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Informed1_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Informed2_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Informed3_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Informed4_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Informed5_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Informed6_pos <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pos_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 7])), ", ")

  Informed1_pos_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 9])), ", ")
  
  Informed2_pos_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 11])), ", ")
  
  Informed3_pos_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 13])), ", ")
  
  Informed4_pos_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 15])), ", ")
  
  Informed5_pos_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 17])), ", ")
  
  Informed6_pos_set1 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_1[n, 19])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pos <- sapply(MM_pos_set1, function(x) as.numeric(x[i]))
    Informed1_pos <- sapply(Informed1_pos_set1, function(x) as.numeric(x[i]))
    Informed2_pos <- sapply(Informed2_pos_set1, function(x) as.numeric(x[i]))
    Informed3_pos <- sapply(Informed3_pos_set1, function(x) as.numeric(x[i]))
    Informed4_pos <- sapply(Informed4_pos_set1, function(x) as.numeric(x[i]))
    Informed5_pos <- sapply(Informed5_pos_set1, function(x) as.numeric(x[i]))
    Informed6_pos <- sapply(Informed6_pos_set1, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pos[i, n] <- mean(MM_pos, na.rm = TRUE)
    average_Informed1_pos[i, n] <- mean(Informed1_pos, na.rm = TRUE)
    average_Informed2_pos[i, n] <- mean(Informed2_pos, na.rm = TRUE)
    average_Informed3_pos[i, n] <- mean(Informed3_pos, na.rm = TRUE)
    average_Informed4_pos[i, n] <- mean(Informed4_pos, na.rm = TRUE)
    average_Informed5_pos[i, n] <- mean(Informed5_pos, na.rm = TRUE)
    average_Informed6_pos[i, n] <- mean(Informed6_pos, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pos <- rowMeans(average_MM_pos, na.rm = TRUE)
overall_average_Informed1_pos <- rowMeans(average_Informed1_pos, na.rm = TRUE)
overall_average_Informed2_pos <- rowMeans(average_Informed2_pos, na.rm = TRUE)
overall_average_Informed3_pos <- rowMeans(average_Informed3_pos, na.rm = TRUE)
overall_average_Informed4_pos <- rowMeans(average_Informed4_pos, na.rm = TRUE)
overall_average_Informed5_pos <- rowMeans(average_Informed5_pos, na.rm = TRUE)
overall_average_Informed6_pos <- rowMeans(average_Informed6_pos, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pos, type = "l", pch = 16, col = "black", main = "Overall Average Position", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pos, overall_average_Informed1_pos, overall_average_Informed2_pos, overall_average_Informed3_pos, overall_average_Informed4_pos, overall_average_Informed5_pos, overall_average_Informed6_pos)), max(c(overall_average_MM_pos, overall_average_Informed1_pos, overall_average_Informed2_pos, overall_average_Informed3_pos, overall_average_Informed4_pos, overall_average_Informed5_pos, overall_average_Informed6_pos))))
lines(overall_average_Informed1_pos, type = "l", pch = 16, col = "red")
lines(overall_average_Informed2_pos, type = "l", pch = 16, col = "green")
lines(overall_average_Informed3_pos, type = "l", pch = 16, col = "yellow")
lines(overall_average_Informed4_pos, type = "l", pch = 16, col = "blue")
lines(overall_average_Informed5_pos, type = "l", pch = 16, col = "purple")
lines(overall_average_Informed6_pos, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed 1", "Informed 2", "Informed 3", "Informed 4", "Informed 5", "Informed 6"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```



## set 2 (1 Informed + 1 noisy informed + 1 noisy + 1 stochastic noisy + 1 mr + 1 mom)

```{r}
# Initialize matrices to store averages for each position
average_true <- matrix(NA, nrow = 100, ncol = 10)
average_expected <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  TrueValues_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 2])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  ExpectedValues_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 3])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    True_values <- sapply(TrueValues_set1, function(x) as.numeric(x[i]))
    Expected_values <- sapply(ExpectedValues_set1, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_true[i, n] <- mean(True_values, na.rm = TRUE)
    average_expected[i, n] <- mean(Expected_values, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_true <- rowMeans(average_true, na.rm = TRUE)
overall_average_expected <- rowMeans(average_expected, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_true, type = "l", pch = 16, col = "blue", main = "Overall Average of True vs Expected Values", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_true, overall_average_expected)), max(c(overall_average_true, overall_average_expected))))
lines(overall_average_expected, type = "l", pch = 16, col = "red")
legend("topright", legend = c("True Values", "Expected Values"), col = c("blue", "red"), lty = 1, cex = 0.8)
```

```{r}
# Initialize matrices to store averages for each position
average_bid <- matrix(NA, nrow = 100, ncol = 10)
average_ask <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  Bids_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 4])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  Asks_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 5])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    Bids <- sapply(Bids_set2, function(x) as.numeric(x[i]))
    Asks <- sapply(Asks_set2, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_bid[i, n] <- mean(Bids, na.rm = TRUE)
    average_ask[i, n] <- mean(Asks, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_bid <- rowMeans(average_bid, na.rm = TRUE)
overall_average_ask <- rowMeans(average_ask, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_bid, type = "l", pch = 16, col = "blue", main = "Overall Average of Bids vs Asks", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_bid, overall_average_ask)), max(c(overall_average_bid, overall_average_ask))))
lines(overall_average_ask, type = "l", pch = 16, col = "red")
legend("topright", legend = c("Bids", "Asks"), col = c("blue", "red"), lty = 1, cex = 0.8)
```

```{r}
# Initialize matrices to store averages for each position
average_MM_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_StochNoisy_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_mr_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_mom_pnl <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pnl_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 6])), ", ")

  Informed_pnl_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 8])), ", ")
  
  NoisyInformed_pnl_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 10])), ", ")
  
  Noisy_pnl_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 12])), ", ")
  
  StochNoisy_pnl_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 14])), ", ")
  
  mr_pnl_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 16])), ", ")
  
  mom_pnl_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 18])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pnl <- sapply(MM_pnl_set2, function(x) as.numeric(x[i]))
    Informed_pnl <- sapply(Informed_pnl_set2, function(x) as.numeric(x[i]))
    NoisyInformed_pnl <- sapply(NoisyInformed_pnl_set2, function(x) as.numeric(x[i]))
    Noisy_pnl <- sapply(Noisy_pnl_set2, function(x) as.numeric(x[i]))
    StochNoisy_pnl <- sapply(StochNoisy_pnl_set2, function(x) as.numeric(x[i]))
    mr_pnl <- sapply(mr_pnl_set2, function(x) as.numeric(x[i]))
    mom_pnl <- sapply(mom_pnl_set2, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pnl[i, n] <- mean(MM_pnl, na.rm = TRUE)
    average_Informed_pnl[i, n] <- mean(Informed_pnl, na.rm = TRUE)
    average_NoisyInformed_pnl[i, n] <- mean(NoisyInformed_pnl, na.rm = TRUE)
    average_Noisy_pnl[i, n] <- mean(Noisy_pnl, na.rm = TRUE)
    average_StochNoisy_pnl[i, n] <- mean(StochNoisy_pnl, na.rm = TRUE)
    average_mr_pnl[i, n] <- mean(mr_pnl, na.rm = TRUE)
    average_mom_pnl[i, n] <- mean(mom_pnl, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pnl <- rowMeans(average_MM_pnl, na.rm = TRUE)
overall_average_Informed_pnl <- rowMeans(average_Informed_pnl, na.rm = TRUE)
overall_average_NoisyInformed_pnl <- rowMeans(average_NoisyInformed_pnl, na.rm = TRUE)
overall_average_Noisy_pnl <- rowMeans(average_Noisy_pnl, na.rm = TRUE)
overall_average_StochNoisy_pnl <- rowMeans(average_StochNoisy_pnl, na.rm = TRUE)
overall_average_mr_pnl <- rowMeans(average_mr_pnl, na.rm = TRUE)
overall_average_mom_pnl <- rowMeans(average_mom_pnl, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pnl, type = "l", pch = 16, col = "black", main = "Overall Average PNL", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pnl, overall_average_Informed_pnl, overall_average_NoisyInformed_pnl, overall_average_Noisy_pnl, overall_average_StochNoisy_pnl, overall_average_mr_pnl, overall_average_mom_pnl)), max(c(overall_average_MM_pnl, overall_average_Informed_pnl, overall_average_NoisyInformed_pnl, overall_average_Noisy_pnl, overall_average_StochNoisy_pnl, overall_average_mr_pnl, overall_average_mom_pnl))))
lines(overall_average_Informed_pnl, type = "l", pch = 16, col = "red")
lines(overall_average_NoisyInformed_pnl, type = "l", pch = 16, col = "green")
lines(overall_average_Noisy_pnl, type = "l", pch = 16, col = "yellow")
lines(overall_average_StochNoisy_pnl, type = "l", pch = 16, col = "blue")
lines(overall_average_mr_pnl, type = "l", pch = 16, col = "purple")
lines(overall_average_mom_pnl, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed", "Noisy Informed", "Noisy", "Stochastic Noisy", "Mean Reversion", "Momentum"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```

```{r}
# Initialize matrices to store averages for each position
average_MM_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Informed_pos <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy_pos <- matrix(NA, nrow = 100, ncol = 10)
average_StochNoisy_pos <- matrix(NA, nrow = 100, ncol = 10)
average_mr_pos <- matrix(NA, nrow = 100, ncol = 10)
average_mom_pos <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pos_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 7])), ", ")

  Informed_pos_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 9])), ", ")
  
  NoisyInformed_pos_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 11])), ", ")
  
  Noisy_pos_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 13])), ", ")
  
  StochNoisy_pos_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 15])), ", ")
  
  mr_pos_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 17])), ", ")
  
  mom_pos_set2 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_2[n, 19])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pos <- sapply(MM_pos_set2, function(x) as.numeric(x[i]))
    Informed_pos <- sapply(Informed_pos_set2, function(x) as.numeric(x[i]))
    NoisyInformed_pos <- sapply(NoisyInformed_pos_set2, function(x) as.numeric(x[i]))
    Noisy_pos <- sapply(Noisy_pos_set2, function(x) as.numeric(x[i]))
    StochNoisy_pos <- sapply(StochNoisy_pos_set2, function(x) as.numeric(x[i]))
    mr_pos <- sapply(mr_pos_set2, function(x) as.numeric(x[i]))
    mom_pos <- sapply(mom_pos_set2, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pos[i, n] <- mean(MM_pos, na.rm = TRUE)
    average_Informed_pos[i, n] <- mean(Informed_pos, na.rm = TRUE)
    average_NoisyInformed_pos[i, n] <- mean(NoisyInformed_pos, na.rm = TRUE)
    average_Noisy_pos[i, n] <- mean(Noisy_pos, na.rm = TRUE)
    average_StochNoisy_pos[i, n] <- mean(StochNoisy_pos, na.rm = TRUE)
    average_mr_pos[i, n] <- mean(mr_pos, na.rm = TRUE)
    average_mom_pos[i, n] <- mean(mom_pos, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pos <- rowMeans(average_MM_pos, na.rm = TRUE)
overall_average_Informed_pos <- rowMeans(average_Informed_pos, na.rm = TRUE)
overall_average_NoisyInformed_pos <- rowMeans(average_NoisyInformed_pos, na.rm = TRUE)
overall_average_Noisy_pos <- rowMeans(average_Noisy_pos, na.rm = TRUE)
overall_average_StochNoisy_pos <- rowMeans(average_StochNoisy_pos, na.rm = TRUE)
overall_average_mr_pos <- rowMeans(average_mr_pos, na.rm = TRUE)
overall_average_mom_pos <- rowMeans(average_mom_pos, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pos, type = "l", pch = 16, col = "black", main = "Overall Average Position", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pos, overall_average_Informed_pos, overall_average_NoisyInformed_pos, overall_average_Noisy_pos, overall_average_StochNoisy_pos, overall_average_mr_pos, overall_average_mom_pos)), max(c(overall_average_MM_pos, overall_average_Informed_pos, overall_average_NoisyInformed_pos, overall_average_Noisy_pos, overall_average_StochNoisy_pos, overall_average_mr_pos, overall_average_mom_pos))))
lines(overall_average_Informed_pos, type = "l", pch = 16, col = "red")
lines(overall_average_NoisyInformed_pos, type = "l", pch = 16, col = "green")
lines(overall_average_Noisy_pos, type = "l", pch = 16, col = "yellow")
lines(overall_average_StochNoisy_pos, type = "l", pch = 16, col = "blue")
lines(overall_average_mr_pos, type = "l", pch = 16, col = "purple")
lines(overall_average_mom_pos, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed", "Noisy Informed", "Noisy", "Stochastic Noisy", "Mean Reversion", "Momentum"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```


## set 3 (2 stochastic noisy + 2 mr + 2 mom)

```{r}
# Initialize matrices to store averages for each position
average_true <- matrix(NA, nrow = 100, ncol = 10)
average_expected <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  TrueValues_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 2])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  ExpectedValues_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 3])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    True_values <- sapply(TrueValues_set3, function(x) as.numeric(x[i]))
    Expected_values <- sapply(ExpectedValues_set3, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_true[i, n] <- mean(True_values, na.rm = TRUE)
    average_expected[i, n] <- mean(Expected_values, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_true <- rowMeans(average_true, na.rm = TRUE)
overall_average_expected <- rowMeans(average_expected, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_true, type = "l", pch = 16, col = "blue", main = "Overall Average of True vs Expected Values", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_true, overall_average_expected)), max(c(overall_average_true, overall_average_expected))))
lines(overall_average_expected, type = "l", pch = 16, col = "red")
legend("topright", legend = c("True Values", "Expected Values"), col = c("blue", "red"), lty = 1, cex = 0.8)
```


```{r}
# Initialize matrices to store averages for each position
average_bid <- matrix(NA, nrow = 100, ncol = 10)
average_ask <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  Bids_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 4])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  Asks_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 5])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    Bids <- sapply(Bids_set3, function(x) as.numeric(x[i]))
    Asks <- sapply(Asks_set3, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_bid[i, n] <- mean(Bids, na.rm = TRUE)
    average_ask[i, n] <- mean(Asks, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_bid <- rowMeans(average_bid, na.rm = TRUE)
overall_average_ask <- rowMeans(average_ask, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_bid, type = "l", pch = 16, col = "blue", main = "Overall Average of Bids vs Asks", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_bid, overall_average_ask)), max(c(overall_average_bid, overall_average_ask))))
lines(overall_average_ask, type = "l", pch = 16, col = "red")
legend("topright", legend = c("Bids", "Asks"), col = c("blue", "red"), lty = 1, cex = 0.8)
```

```{r}
# Initialize matrices to store averages for each position
average_MM_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_StochNoisy1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_StochNoisy2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_mr1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_mr2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_mom1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_mom2_pnl <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pnl_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 6])), ", ")

  StochNoisy1_pnl_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 8])), ", ")
  
  StochNoisy2_pnl_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 10])), ", ")
  
  mr1_pnl_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 12])), ", ")
  
  mr2_pnl_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 14])), ", ")
  
  mom1_pnl_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 16])), ", ")
  
  mom2_pnl_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 18])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pnl <- sapply(MM_pnl_set3, function(x) as.numeric(x[i]))
    StochNoisy1_pnl <- sapply(StochNoisy1_pnl_set3, function(x) as.numeric(x[i]))
    StochNoisy2_pnl <- sapply(StochNoisy2_pnl_set3, function(x) as.numeric(x[i]))
    mr1_pnl <- sapply(mr1_pnl_set3, function(x) as.numeric(x[i]))
    mr2_pnl <- sapply(mr2_pnl_set3, function(x) as.numeric(x[i]))
    mom1_pnl <- sapply(mom1_pnl_set3, function(x) as.numeric(x[i]))
    mom2_pnl <- sapply(mom2_pnl_set3, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pnl[i, n] <- mean(MM_pnl, na.rm = TRUE)
    average_StochNoisy1_pnl[i, n] <- mean(StochNoisy1_pnl, na.rm = TRUE)
    average_StochNoisy2_pnl[i, n] <- mean(StochNoisy2_pnl, na.rm = TRUE)
    average_mr1_pnl[i, n] <- mean(mr1_pnl, na.rm = TRUE)
    average_mr2_pnl[i, n] <- mean(mr2_pnl, na.rm = TRUE)
    average_mom1_pnl[i, n] <- mean(mom1_pnl, na.rm = TRUE)
    average_mom2_pnl[i, n] <- mean(mom2_pnl, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pnl <- rowMeans(average_MM_pnl, na.rm = TRUE)
overall_average_StochNoisy1_pnl <- rowMeans(average_StochNoisy1_pnl, na.rm = TRUE)
overall_average_StochNoisy2_pnl <- rowMeans(average_StochNoisy2_pnl, na.rm = TRUE)
overall_average_mr1_pnl <- rowMeans(average_mr1_pnl, na.rm = TRUE)
overall_average_mr2_pnl <- rowMeans(average_mr2_pnl, na.rm = TRUE)
overall_average_mom1_pnl <- rowMeans(average_mom1_pnl, na.rm = TRUE)
overall_average_mom2_pnl <- rowMeans(average_mom2_pnl, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pnl, type = "l", pch = 16, col = "black", main = "Overall Average PNL", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pnl, overall_average_StochNoisy1_pnl, overall_average_StochNoisy2_pnl, overall_average_mr1_pnl, overall_average_mr2_pnl, overall_average_mom1_pnl, overall_average_mom2_pnl)), max(c(overall_average_MM_pnl, overall_average_StochNoisy1_pnl, overall_average_StochNoisy2_pnl, overall_average_mr1_pnl, overall_average_mr2_pnl, overall_average_mom1_pnl, overall_average_mom2_pnl))))
lines(overall_average_StochNoisy1_pnl, type = "l", pch = 16, col = "red")
lines(overall_average_StochNoisy2_pnl, type = "l", pch = 16, col = "green")
lines(overall_average_mr1_pnl, type = "l", pch = 16, col = "yellow")
lines(overall_average_mr2_pnl, type = "l", pch = 16, col = "blue")
lines(overall_average_mom1_pnl, type = "l", pch = 16, col = "purple")
lines(overall_average_mom2_pnl, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Stochastic Noisy 1", "Stochastic Noisy 2", "Mean Reversion 1", "Mean Reversion 2", "Momentum 1", "Momentum 2"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```


```{r}
# Initialize matrices to store averages for each position
average_MM_pos <- matrix(NA, nrow = 100, ncol = 10)
average_StochNoisy1_pos <- matrix(NA, nrow = 100, ncol = 10)
average_StochNoisy2_pos <- matrix(NA, nrow = 100, ncol = 10)
average_mr1_pos <- matrix(NA, nrow = 100, ncol = 10)
average_mr2_pos <- matrix(NA, nrow = 100, ncol = 10)
average_mom1_pos <- matrix(NA, nrow = 100, ncol = 10)
average_mom2_pos <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pos_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 7])), ", ")

  StochNoisy1_pos_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 9])), ", ")
  
  StochNoisy2_pos_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 11])), ", ")
  
  mr1_pos_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 12])), ", ")
  
  mr2_pos_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 15])), ", ")
  
  mom1_pos_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 17])), ", ")
  
  mom2_pos_set3 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_3[n, 19])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pos <- sapply(MM_pos_set3, function(x) as.numeric(x[i]))
    StochNoisy1_pos <- sapply(StochNoisy1_pos_set3, function(x) as.numeric(x[i]))
    StochNoisy2_pos <- sapply(StochNoisy2_pos_set3, function(x) as.numeric(x[i]))
    mr1_pos <- sapply(mr1_pos_set3, function(x) as.numeric(x[i]))
    mr2_pos <- sapply(mr2_pos_set3, function(x) as.numeric(x[i]))
    mom1_pos <- sapply(mom1_pos_set3, function(x) as.numeric(x[i]))
    mom2_pos <- sapply(mom2_pos_set3, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pos[i, n] <- mean(MM_pos, na.rm = TRUE)
    average_StochNoisy1_pos[i, n] <- mean(StochNoisy1_pos, na.rm = TRUE)
    average_StochNoisy2_pos[i, n] <- mean(StochNoisy2_pos, na.rm = TRUE)
    average_mr1_pos[i, n] <- mean(mr1_pos, na.rm = TRUE)
    average_mr2_pos[i, n] <- mean(mr2_pos, na.rm = TRUE)
    average_mom1_pos[i, n] <- mean(mom1_pos, na.rm = TRUE)
    average_mom2_pos[i, n] <- mean(mom2_pos, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pos <- rowMeans(average_MM_pos, na.rm = TRUE)
overall_average_StochNoisy1_pos <- rowMeans(average_StochNoisy1_pos, na.rm = TRUE)
overall_average_StochNoisy2_pos <- rowMeans(average_StochNoisy2_pos, na.rm = TRUE)
overall_average_mr1_pos <- rowMeans(average_mr1_pos, na.rm = TRUE)
overall_average_mr2_pos <- rowMeans(average_mr2_pos, na.rm = TRUE)
overall_average_mom1_pos <- rowMeans(average_mom1_pos, na.rm = TRUE)
overall_average_mom2_pos <- rowMeans(average_mom2_pos, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pos, type = "l", pch = 16, col = "black", main = "Overall Average Position", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pos, overall_average_StochNoisy1_pos, overall_average_StochNoisy2_pos, overall_average_mr1_pos, overall_average_mr2_pos, overall_average_mom1_pos, overall_average_mom2_pos)), max(c(overall_average_MM_pos, overall_average_StochNoisy1_pos, overall_average_StochNoisy2_pos, overall_average_mr1_pos, overall_average_mr2_pos, overall_average_mom1_pos, overall_average_mom2_pos))))
lines(overall_average_StochNoisy1_pos, type = "l", pch = 16, col = "red")
lines(overall_average_StochNoisy2_pos, type = "l", pch = 16, col = "green")
lines(overall_average_mr1_pos, type = "l", pch = 16, col = "yellow")
lines(overall_average_mr2_pos, type = "l", pch = 16, col = "blue")
lines(overall_average_mom1_pos, type = "l", pch = 16, col = "purple")
lines(overall_average_mom2_pos, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Stochastic Noisy 1", "Stochastic Noisy 2", "Mean Reversion 1", "Mean Reversion 2", "Momentum 1", "Momentum 2"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```



## set 4 (1 informed + 2 noisy informed + 2 noisy + 1 stochastic noisy)

```{r}
# Initialize empty vectors to store true and expected values
TrueValues_set4 <- numeric()
ExpectedValues_set4 <- numeric()

# Loop through each iteration (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_1 dataframe
  TrueValue_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 2])), ", ")[[1]]
  
  # Extract Expected values from the aggregated_results_1 dataframe
  ExpectedValue_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 3])), ", ")[[1]]
  
  # Append the True and Expected values to their respective vectors
  TrueValues_set4 <- c(TrueValues_set4, as.numeric(TrueValue_set4))
  ExpectedValues_set4 <- c(ExpectedValues_set4, as.numeric(ExpectedValue_set4))
}

# Calculate the average of True values
average_true <- mean(TrueValues_set4)

# Calculate the average of Expected values
average_expected <- mean(ExpectedValues_set4)

# Plot True and Expected values on the same plot
plot(TrueValues_set4, type = "l", pch = 16, col = "blue", main = "True vs Expected Values in set 4", xlab = "Iteration", ylab = "Value")
lines(ExpectedValues_set4, type = "l", pch = 16, col = "red")

# Add legend
legend("topright", legend = c("True Values", "Expected Values"), col = c("blue", "red"), lty = 1, cex = 0.8)

# Add horizontal lines for the averages
abline(h = average_true, col = "blue", lwd = 1)
abline(h = average_expected, col = "red", lwd = 1)
```

```{r}
# Initialize matrices to store averages for each position
average_true <- matrix(NA, nrow = 100, ncol = 10)
average_expected <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  TrueValues_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 2])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  ExpectedValues_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 3])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    True_values <- sapply(TrueValues_set4, function(x) as.numeric(x[i]))
    Expected_values <- sapply(ExpectedValues_set4, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_true[i, n] <- mean(True_values, na.rm = TRUE)
    average_expected[i, n] <- mean(Expected_values, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_true <- rowMeans(average_true, na.rm = TRUE)
overall_average_expected <- rowMeans(average_expected, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_true, type = "l", pch = 16, col = "blue", main = "Overall Average of True vs Expected Values", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_true, overall_average_expected)), max(c(overall_average_true, overall_average_expected))))
lines(overall_average_expected, type = "l", pch = 16, col = "red")
legend("topright", legend = c("True Values", "Expected Values"), col = c("blue", "red"), lty = 1, cex = 0.8)

```




```{r}
# Initialize empty vectors to store the Bid and Ask values
Bids_set4 <- numeric()
Asks_set4 <- numeric()

# Loop through each iteration (n)
for (n in 1:10) {
  # Extract Bid values from the aggregated_results_1 dataframe
  Bid_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 4])), ", ")[[1]]
  
  # Extract Ask values from the aggregated_results_1 dataframe (next column)
  Ask_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 5])), ", ")[[1]]
  
  # Append the Bid and Ask values to their respective vectors
  Bids_set4 <- c(Bids_set4, as.numeric(Bid_set4))
  Asks_set4 <- c(Asks_set4, as.numeric(Ask_set4))
}

# Calculate the average of Bid and Ask values
average_bids <- mean(Bids_set4, na.rm = TRUE)
average_asks <- mean(Asks_set4, na.rm = TRUE)

# Plot the Bid and Ask values on the same plot
plot(Bids_set4, type = "l", pch = 16, col = "blue", main = "Bids vs Asks in set 4", xlab = "Iteration", ylab = "Value", ylim = c(min(c(Bids_set4, Asks_set4)), max(c(Bids_set4, Asks_set4))))
lines(Asks_set4, type = "l", pch = 16, col = "red")

# Add legend
legend("topright", legend = c("Bids", "Asks"), col = c("blue", "red"), lty = 1, cex = 0.8)

# Add horizontal lines for the averages
abline(h = average_bids, col = "blue", lty = 1)
abline(h = average_asks, col = "red", lty = 1)
```


```{r}
# Initialize matrices to store averages for each position
average_bid <- matrix(NA, nrow = 100, ncol = 10)
average_ask <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  Bids_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 4])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  Asks_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 5])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    Bids <- sapply(Bids_set4, function(x) as.numeric(x[i]))
    Asks <- sapply(Asks_set4, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_bid[i, n] <- mean(Bids, na.rm = TRUE)
    average_ask[i, n] <- mean(Asks, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_bid <- rowMeans(average_bid, na.rm = TRUE)
overall_average_ask <- rowMeans(average_ask, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_bid, type = "l", pch = 16, col = "blue", main = "Overall Average of Bids vs Asks", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_bid, overall_average_ask)), max(c(overall_average_bid, overall_average_ask))))
lines(overall_average_ask, type = "l", pch = 16, col = "red")
legend("topright", legend = c("Bids", "Asks"), col = c("blue", "red"), lty = 1, cex = 0.8)
```



```{r}
# Initialize empty vectors to store the Bid and Ask values
MM_pnl_set4 <- numeric()
Informed_pnl_set4 <- numeric()
NoisyInformed1_pnl_set4 <- numeric()
NoisyInformed2_pnl_set4 <- numeric()
Noisy1_pnl_set4 <- numeric()
Noisy2_pnl_set4 <- numeric()
StochNoisy_pnl_set4 <- numeric()

# Loop through each iteration (n)
for (n in 1:10) {

  MM_pnl_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 6])), ", ")[[1]]
  
  Informed_pnl_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 8])), ", ")[[1]]
  
  NoisyInformed1_pnl_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 10])), ", ")[[1]]
  
  NoisyInformed2_pnl_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 12])), ", ")[[1]]
  
  Noisy1_pnl_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 14])), ", ")[[1]]
  
  Noisy2_pnl_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 16])), ", ")[[1]]
  
  StochNoisy_pnl_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 18])), ", ")[[1]]
  
  # Convert Bid and Ask values to numeric and append to the vectors
  MM_pnl_set4 <- c(MM_pnl_set4, as.numeric(MM_pnl_values))
  Informed_pnl_set4 <- c(Informed_pnl_set4, as.numeric(Informed_pnl_values))
  NoisyInformed1_pnl_set4 <- c(NoisyInformed1_pnl_set4, as.numeric(NoisyInformed1_pnl_values))
  NoisyInformed2_pnl_set4 <- c(NoisyInformed2_pnl_set4, as.numeric(NoisyInformed2_pnl_values))
  Noisy1_pnl_set4 <- c(Noisy_pnl_set4, as.numeric(Noisy1_pnl_values))
  Noisy2_pnl_set4 <- c(Noisy2_pnl_set4, as.numeric(Noisy2_pnl_values))
  StochNoisy_pnl_set4 <- c(StochNoisy_pnl_set4, as.numeric(StochNoisy_pnl_values))
}

# Calculate the average of Bid and Ask values
#average_MM <- mean(MM_set4, na.rm = TRUE)
#average_IN <- mean(IN_set4, na.rm = TRUE)

# Plot the Bid and Ask values on the same plot
plot(MM_pnl_set4, type = "l", pch = 16, col = "black", main = "PNL in set 4", xlab = "Iteration", ylab = "Value", ylim = c(min(c(MM_pnl_set4, Informed_pnl_set4, NoisyInformed1_pnl_set4, NoisyInformed2_pnl_set4, Noisy1_pnl_set4, Noisy2_pnl_set4, StochNoisy_pnl_set4)), max(c(MM_pnl_set4, Informed_pnl_set4, NoisyInformed1_pnl_set4, NoisyInformed2_pnl_set4, Noisy1_pnl_set4, Noisy2_pnl_set4, StochNoisy_pnl_set4))))
lines(Informed_pnl_set4, type = "l", pch = 16, col = "red")
lines(NoisyInformed1_pnl_set4, type = "l", pch = 16, col = "green")
lines(NoisyInformed2_pnl_set4, type = "l", pch = 16, col = "yellow")
lines(Noisy1_pnl_set4, type = "l", pch = 16, col = "blue")
lines(Noisy2_pnl_set4, type = "l", pch = 16, col = "purple")
lines(StochNoisy_pnl_set4, type = "l", pch = 16, col = "orange")


# Add legend
legend("bottomright", legend = c("Market Maker", "Informed", "Noisy Informed 1", "Noisy Informed 2", "Noisy 1", "Noisy 2", "Stochastic Noisy"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)

# Add horizontal lines for the averages
#abline(h = average_MM, col = "blue", lty = 1)
#abline(h = average_IN, col = "red", lty = 1)

```

```{r}
# Initialize matrices to store averages for each position
average_MM_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_StochNoisy_pnl <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pnl_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 6])), ", ")

  Informed_pnl_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 8])), ", ")
  
  NoisyInformed1_pnl_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 10])), ", ")
  
  NoisyInformed2_pnl_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 12])), ", ")
  
  Noisy1_pnl_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 14])), ", ")
  
  Noisy2_pnl_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 16])), ", ")
  
  StochNoisy_pnl_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 18])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pnl <- sapply(MM_pnl_set4, function(x) as.numeric(x[i]))
    Informed_pnl <- sapply(Informed_pnl_set4, function(x) as.numeric(x[i]))
    NoisyInformed1_pnl <- sapply(NoisyInformed1_pnl_set4, function(x) as.numeric(x[i]))
    NoisyInformed2_pnl <- sapply(NoisyInformed2_pnl_set4, function(x) as.numeric(x[i]))
    Noisy1_pnl <- sapply(Noisy1_pnl_set4, function(x) as.numeric(x[i]))
    Noisy2_pnl <- sapply(Noisy2_pnl_set4, function(x) as.numeric(x[i]))
    StochNoisy_pnl <- sapply(StochNoisy_pnl_set4, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pnl[i, n] <- mean(MM_pnl, na.rm = TRUE)
    average_Informed_pnl[i, n] <- mean(Informed_pnl, na.rm = TRUE)
    average_NoisyInformed1_pnl[i, n] <- mean(NoisyInformed1_pnl, na.rm = TRUE)
    average_NoisyInformed2_pnl[i, n] <- mean(NoisyInformed2_pnl, na.rm = TRUE)
    average_Noisy1_pnl[i, n] <- mean(Noisy1_pnl, na.rm = TRUE)
    average_Noisy2_pnl[i, n] <- mean(Noisy2_pnl, na.rm = TRUE)
    average_StochNoisy_pnl[i, n] <- mean(StochNoisy_pnl, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pnl <- rowMeans(average_MM_pnl, na.rm = TRUE)
overall_average_Informed_pnl <- rowMeans(average_Informed_pnl, na.rm = TRUE)
overall_average_NoisyInformed1_pnl <- rowMeans(average_NoisyInformed1_pnl, na.rm = TRUE)
overall_average_NoisyInformed2_pnl <- rowMeans(average_NoisyInformed2_pnl, na.rm = TRUE)
overall_average_Noisy1_pnl <- rowMeans(average_Noisy1_pnl, na.rm = TRUE)
overall_average_Noisy2_pnl <- rowMeans(average_Noisy2_pnl, na.rm = TRUE)
overall_average_StochNoisy_pnl <- rowMeans(average_StochNoisy_pnl, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pnl, type = "l", pch = 16, col = "black", main = "Overall Average PNL", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pnl, overall_average_Informed_pnl, overall_average_NoisyInformed1_pnl, overall_average_NoisyInformed2_pnl, overall_average_Noisy1_pnl, overall_average_Noisy2_pnl, overall_average_StochNoisy_pnl)), max(c(overall_average_MM_pnl, overall_average_Informed_pnl, overall_average_NoisyInformed1_pnl, overall_average_NoisyInformed2_pnl, overall_average_Noisy1_pnl, overall_average_Noisy2_pnl, overall_average_StochNoisy_pnl))))
lines(overall_average_Informed_pnl, type = "l", pch = 16, col = "red")
lines(overall_average_NoisyInformed1_pnl, type = "l", pch = 16, col = "green")
lines(overall_average_NoisyInformed2_pnl, type = "l", pch = 16, col = "yellow")
lines(overall_average_Noisy1_pnl, type = "l", pch = 16, col = "blue")
lines(overall_average_Noisy2_pnl, type = "l", pch = 16, col = "purple")
lines(overall_average_StochNoisy_pnl, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed", "Noisy Informed 1", "Noisy Informed 2", "Noisy 1", "Noisy 2", "Stochastic Noisy"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```


```{r}
# Initialize empty vectors to store the Bid and Ask values
MM_pos_set4 <- numeric()
Informed_pos_set4 <- numeric()
NoisyInformed1_pos_set4 <- numeric()
NoisyInformed2_pos_set4 <- numeric()
Noisy1_pos_set4 <- numeric()
Noisy2_pos_set4 <- numeric()
StochNoisy_pos_set4 <- numeric()

# Loop through each iteration (n)
for (n in 1:10) {

  MM_pos_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 7])), ", ")[[1]]
  
  Informed_pos_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 9])), ", ")[[1]]
  
  NoisyInformed1_pos_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 11])), ", ")[[1]]
  
  NoisyInformed2_pos_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 13])), ", ")[[1]]
  
  Noisy1_pos_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 15])), ", ")[[1]]
  
  Noisy2_pos_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 17])), ", ")[[1]]
  
  StochNoisy_pos_values <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 19])), ", ")[[1]]
  
  # Convert Bid and Ask values to numeric and append to the vectors
  MM_pos_set4 <- c(MM_pos_set4, as.numeric(MM_pos_values))
  Informed_pos_set4 <- c(Informed_pos_set4, as.numeric(Informed_pos_values))
  NoisyInformed1_pos_set4 <- c(NoisyInformed1_pos_set4, as.numeric(NoisyInformed1_pos_values))
  NoisyInformed2_pos_set4 <- c(NoisyInformed2_pos_set4, as.numeric(NoisyInformed2_pos_values))
  Noisy1_pos_set4 <- c(Noisy_pos_set4, as.numeric(Noisy1_pos_values))
  Noisy2_pos_set4 <- c(Noisy2_pos_set4, as.numeric(Noisy2_pos_values))
  StochNoisy_pos_set4 <- c(StochNoisy_pos_set4, as.numeric(StochNoisy_pos_values))
}

# Calculate the average of Bid and Ask values
#average_MM <- mean(MM_set4, na.rm = TRUE)
#average_IN <- mean(IN_set4, na.rm = TRUE)

# Plot the Bid and Ask values on the same plot
plot(MM_pos_set4, type = "l", pch = 16, col = "black", main = "Position in set 4", xlab = "Iteration", ylab = "Value", ylim = c(min(c(MM_pos_set4, Informed_pos_set4, NoisyInformed1_pos_set4, NoisyInformed2_pos_set4, Noisy1_pos_set4, Noisy2_pos_set4, StochNoisy_pos_set4)), max(c(MM_pos_set4, Informed_pos_set4, NoisyInformed1_pos_set4, NoisyInformed2_pos_set4, Noisy1_pos_set4, Noisy2_pos_set4, StochNoisy_pos_set4))))
lines(Informed_pos_set4, type = "l", pch = 16, col = "red")
lines(NoisyInformed1_pos_set4, type = "l", pch = 16, col = "green")
lines(NoisyInformed2_pos_set4, type = "l", pch = 16, col = "yellow")
lines(Noisy1_pos_set4, type = "l", pch = 16, col = "blue")
lines(Noisy2_pos_set4, type = "l", pch = 16, col = "purple")
lines(StochNoisy_pos_set4, type = "l", pch = 16, col = "orange")


# Add legend
legend("topleft", legend = c("Market Maker", "Informed", "Noisy Informed 1", "Noisy Informed 2", "Noisy 1", "Noisy 2", "Stochastic Noisy"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)

# Add horizontal lines for the averages
#abline(h = average_MM, col = "blue", lty = 1)
#abline(h = average_IN, col = "red", lty = 1)
```


```{r}
# Initialize matrices to store averages for each position
average_MM_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Informed_pos <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed1_pos <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed2_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy1_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy2_pos <- matrix(NA, nrow = 100, ncol = 10)
average_StochNoisy_pos <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pos_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 7])), ", ")

  Informed_pos_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 9])), ", ")
  
  NoisyInformed1_pos_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 11])), ", ")
  
  NoisyInformed2_pos_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 13])), ", ")
  
  Noisy1_pos_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 15])), ", ")
  
  Noisy2_pos_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 17])), ", ")
  
  StochNoisy_pos_set4 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 19])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pos <- sapply(MM_pos_set4, function(x) as.numeric(x[i]))
    Informed_pos <- sapply(Informed_pos_set4, function(x) as.numeric(x[i]))
    NoisyInformed1_pos <- sapply(NoisyInformed1_pos_set4, function(x) as.numeric(x[i]))
    NoisyInformed2_pos <- sapply(NoisyInformed2_pos_set4, function(x) as.numeric(x[i]))
    Noisy1_pos <- sapply(Noisy1_pos_set4, function(x) as.numeric(x[i]))
    Noisy2_pos <- sapply(Noisy2_pos_set4, function(x) as.numeric(x[i]))
    StochNoisy_pos <- sapply(StochNoisy_pos_set4, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pos[i, n] <- mean(MM_pos, na.rm = TRUE)
    average_Informed_pos[i, n] <- mean(Informed_pos, na.rm = TRUE)
    average_NoisyInformed1_pos[i, n] <- mean(NoisyInformed1_pos, na.rm = TRUE)
    average_NoisyInformed2_pos[i, n] <- mean(NoisyInformed2_pos, na.rm = TRUE)
    average_Noisy1_pos[i, n] <- mean(Noisy1_pos, na.rm = TRUE)
    average_Noisy2_pos[i, n] <- mean(Noisy2_pos, na.rm = TRUE)
    average_StochNoisy_pos[i, n] <- mean(StochNoisy_pos, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pos <- rowMeans(average_MM_pos, na.rm = TRUE)
overall_average_Informed_pos <- rowMeans(average_Informed_pos, na.rm = TRUE)
overall_average_NoisyInformed1_pos <- rowMeans(average_NoisyInformed1_pos, na.rm = TRUE)
overall_average_NoisyInformed2_pos <- rowMeans(average_NoisyInformed2_pos, na.rm = TRUE)
overall_average_Noisy1_pos <- rowMeans(average_Noisy1_pos, na.rm = TRUE)
overall_average_Noisy2_pos <- rowMeans(average_Noisy2_pos, na.rm = TRUE)
overall_average_StochNoisy_pos <- rowMeans(average_StochNoisy_pos, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pos, type = "l", pch = 16, col = "black", main = "Overall Average Position", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pos, overall_average_Informed_pos, overall_average_NoisyInformed1_pos, overall_average_NoisyInformed2_pos, overall_average_Noisy1_pos, overall_average_Noisy2_pos, overall_average_StochNoisy_pos)), max(c(overall_average_MM_pos, overall_average_Informed_pos, overall_average_NoisyInformed1_pos, overall_average_NoisyInformed2_pos, overall_average_Noisy1_pos, overall_average_Noisy2_pos, overall_average_StochNoisy_pos))))
lines(overall_average_Informed_pos, type = "l", pch = 16, col = "red")
lines(overall_average_NoisyInformed1_pos, type = "l", pch = 16, col = "green")
lines(overall_average_NoisyInformed2_pos, type = "l", pch = 16, col = "yellow")
lines(overall_average_Noisy1_pos, type = "l", pch = 16, col = "blue")
lines(overall_average_Noisy2_pos, type = "l", pch = 16, col = "purple")
lines(overall_average_StochNoisy_pos, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed", "Noisy Informed 1", "Noisy Informed 2", "Noisy 1", "Noisy 2", "Stochastic Noisy"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```



## set 5 (Noisy*6)

```{r}
# Initialize matrices to store averages for each position
average_true <- matrix(NA, nrow = 100, ncol = 10)
average_expected <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  TrueValues_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 2])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  ExpectedValues_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_4[n, 3])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    True_values <- sapply(TrueValues_set5, function(x) as.numeric(x[i]))
    Expected_values <- sapply(ExpectedValues_set5, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_true[i, n] <- mean(True_values, na.rm = TRUE)
    average_expected[i, n] <- mean(Expected_values, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_true <- rowMeans(average_true, na.rm = TRUE)
overall_average_expected <- rowMeans(average_expected, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_true, type = "l", pch = 16, col = "blue", main = "Overall Average of True vs Expected Values", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_true, overall_average_expected)), max(c(overall_average_true, overall_average_expected))))
lines(overall_average_expected, type = "l", pch = 16, col = "red")
legend("topright", legend = c("True Values", "Expected Values"), col = c("blue", "red"), lty = 1, cex = 0.8)
```


```{r}
# Initialize matrices to store averages for each position
average_bid <- matrix(NA, nrow = 100, ncol = 10)
average_ask <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  Bids_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 4])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  Asks_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 5])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    Bids <- sapply(Bids_set5, function(x) as.numeric(x[i]))
    Asks <- sapply(Asks_set5, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_bid[i, n] <- mean(Bids, na.rm = TRUE)
    average_ask[i, n] <- mean(Asks, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_bid <- rowMeans(average_bid, na.rm = TRUE)
overall_average_ask <- rowMeans(average_ask, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_bid, type = "l", pch = 16, col = "blue", main = "Overall Average of Bids vs Asks", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_bid, overall_average_ask)), max(c(overall_average_bid, overall_average_ask))))
lines(overall_average_ask, type = "l", pch = 16, col = "red")
legend("topright", legend = c("Bids", "Asks"), col = c("blue", "red"), lty = 1, cex = 0.8)
```



```{r}
# Initialize matrices to store averages for each position
average_MM_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy3_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy4_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy5_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy6_pnl <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pnl_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 6])), ", ")

  Noisy1_pnl_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 8])), ", ")
  
  Noisy2_pnl_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 10])), ", ")
  
  Noisy3_pnl_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 12])), ", ")
  
  Noisy4_pnl_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 14])), ", ")
  
  Noisy5_pnl_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 16])), ", ")
  
  Noisy6_pnl_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 18])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pnl <- sapply(MM_pnl_set5, function(x) as.numeric(x[i]))
    Noisy1_pnl <- sapply(Noisy1_pnl_set5, function(x) as.numeric(x[i]))
    Noisy2_pnl <- sapply(Noisy2_pnl_set5, function(x) as.numeric(x[i]))
    Noisy3_pnl <- sapply(Noisy3_pnl_set5, function(x) as.numeric(x[i]))
    Noisy4_pnl <- sapply(Noisy4_pnl_set5, function(x) as.numeric(x[i]))
    Noisy5_pnl <- sapply(Noisy5_pnl_set5, function(x) as.numeric(x[i]))
    Noisy6_pnl <- sapply(Noisy6_pnl_set5, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pnl[i, n] <- mean(MM_pnl, na.rm = TRUE)
    average_Noisy1_pnl[i, n] <- mean(Noisy1_pnl, na.rm = TRUE)
    average_Noisy2_pnl[i, n] <- mean(Noisy2_pnl, na.rm = TRUE)
    average_Noisy3_pnl[i, n] <- mean(Noisy3_pnl, na.rm = TRUE)
    average_Noisy4_pnl[i, n] <- mean(Noisy4_pnl, na.rm = TRUE)
    average_Noisy5_pnl[i, n] <- mean(Noisy5_pnl, na.rm = TRUE)
    average_Noisy6_pnl[i, n] <- mean(Noisy6_pnl, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pnl <- rowMeans(average_MM_pnl, na.rm = TRUE)
overall_average_Noisy1_pnl <- rowMeans(average_Noisy1_pnl, na.rm = TRUE)
overall_average_Noisy2_pnl <- rowMeans(average_Noisy2_pnl, na.rm = TRUE)
overall_average_Noisy3_pnl <- rowMeans(average_Noisy3_pnl, na.rm = TRUE)
overall_average_Noisy4_pnl <- rowMeans(average_Noisy4_pnl, na.rm = TRUE)
overall_average_Noisy5_pnl <- rowMeans(average_Noisy5_pnl, na.rm = TRUE)
overall_average_Noisy6_pnl <- rowMeans(average_Noisy6_pnl, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pnl, type = "l", pch = 16, col = "black", main = "Overall Average PNL", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pnl, overall_average_Noisy1_pnl, overall_average_Noisy2_pnl, overall_average_Noisy3_pnl, overall_average_Noisy4_pnl, overall_average_Noisy5_pnl, overall_average_Noisy6_pnl)), max(c(overall_average_MM_pnl, overall_average_Noisy1_pnl, overall_average_Noisy2_pnl, overall_average_Noisy3_pnl, overall_average_Noisy4_pnl, overall_average_Noisy5_pnl, overall_average_Noisy6_pnl))))
lines(overall_average_Noisy1_pnl, type = "l", pch = 16, col = "red")
lines(overall_average_Noisy2_pnl, type = "l", pch = 16, col = "green")
lines(overall_average_Noisy3_pnl, type = "l", pch = 16, col = "yellow")
lines(overall_average_Noisy4_pnl, type = "l", pch = 16, col = "blue")
lines(overall_average_Noisy5_pnl, type = "l", pch = 16, col = "purple")
lines(overall_average_Noisy6_pnl, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Noisy 1", "Noisy 2", "Noisy 3", "Noisy 4", "Noisy 5", "Noisy 6"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```


```{r}
# Initialize matrices to store averages for each position
average_MM_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy1_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy2_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy3_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy4_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy5_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy6_pos <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pos_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 7])), ", ")

  Noisy1_pos_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 9])), ", ")
  
  Noisy2_pos_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 11])), ", ")
  
  Noisy3_pos_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 13])), ", ")
  
  Noisy4_pos_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 15])), ", ")
  
  Noisy5_pos_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 17])), ", ")
  
  Noisy6_pos_set5 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_5[n, 19])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pos <- sapply(MM_pos_set5, function(x) as.numeric(x[i]))
    Noisy1_pos <- sapply(Noisy1_pos_set5, function(x) as.numeric(x[i]))
    Noisy2_pos <- sapply(Noisy2_pos_set5, function(x) as.numeric(x[i]))
    Noisy3_pos <- sapply(Noisy3_pos_set5, function(x) as.numeric(x[i]))
    Noisy4_pos <- sapply(Noisy4_pos_set5, function(x) as.numeric(x[i]))
    Noisy5_pos <- sapply(Noisy5_pos_set5, function(x) as.numeric(x[i]))
    Noisy6_pos <- sapply(Noisy6_pos_set5, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pos[i, n] <- mean(MM_pos, na.rm = TRUE)
    average_Noisy1_pos[i, n] <- mean(Noisy1_pos, na.rm = TRUE)
    average_Noisy2_pos[i, n] <- mean(Noisy2_pos, na.rm = TRUE)
    average_Noisy3_pos[i, n] <- mean(Noisy3_pos, na.rm = TRUE)
    average_Noisy4_pos[i, n] <- mean(Noisy4_pos, na.rm = TRUE)
    average_Noisy5_pos[i, n] <- mean(Noisy5_pos, na.rm = TRUE)
    average_Noisy6_pos[i, n] <- mean(Noisy6_pos, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pos <- rowMeans(average_MM_pos, na.rm = TRUE)
overall_average_Noisy1_pos <- rowMeans(average_Noisy1_pos, na.rm = TRUE)
overall_average_Noisy2_pos <- rowMeans(average_Noisy2_pos, na.rm = TRUE)
overall_average_Noisy3_pos <- rowMeans(average_Noisy3_pos, na.rm = TRUE)
overall_average_Noisy4_pos <- rowMeans(average_Noisy4_pos, na.rm = TRUE)
overall_average_Noisy5_pos <- rowMeans(average_Noisy5_pos, na.rm = TRUE)
overall_average_Noisy6_pos <- rowMeans(average_Noisy6_pos, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pos, type = "l", pch = 16, col = "black", main = "Overall Average Position", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pos, overall_average_Noisy1_pos, overall_average_Noisy2_pos, overall_average_Noisy3_pos, overall_average_Noisy4_pos, overall_average_Noisy5_pos, overall_average_Noisy6_pos)), max(c(overall_average_MM_pos, overall_average_Noisy1_pos, overall_average_Noisy2_pos, overall_average_Noisy3_pos, overall_average_Noisy4_pos, overall_average_Noisy5_pos, overall_average_Noisy6_pos))))
lines(overall_average_Noisy1_pos, type = "l", pch = 16, col = "red")
lines(overall_average_Noisy2_pos, type = "l", pch = 16, col = "green")
lines(overall_average_Noisy3_pos, type = "l", pch = 16, col = "yellow")
lines(overall_average_Noisy4_pos, type = "l", pch = 16, col = "blue")
lines(overall_average_Noisy5_pos, type = "l", pch = 16, col = "purple")
lines(overall_average_Noisy6_pos, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomright", legend = c("Market Maker", "Noisy 1", "Noisy 2", "Noisy 3", "Noisy 4", "Noisy 5", "Noisy 6"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```


## set6 (1 informed + 5 noisy)

```{r}
# Initialize matrices to store averages for each position
average_true <- matrix(NA, nrow = 100, ncol = 10)
average_expected <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  TrueValues_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 2])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  ExpectedValues_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 3])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    True_values <- sapply(TrueValues_set6, function(x) as.numeric(x[i]))
    Expected_values <- sapply(ExpectedValues_set6, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_true[i, n] <- mean(True_values, na.rm = TRUE)
    average_expected[i, n] <- mean(Expected_values, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_true <- rowMeans(average_true, na.rm = TRUE)
overall_average_expected <- rowMeans(average_expected, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_true, type = "l", pch = 16, col = "blue", main = "Overall Average of True vs Expected Values", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_true, overall_average_expected)), max(c(overall_average_true, overall_average_expected))))
lines(overall_average_expected, type = "l", pch = 16, col = "red")
legend("topright", legend = c("True Values", "Expected Values"), col = c("blue", "red"), lty = 1, cex = 0.8)
```



```{r}
# Initialize matrices to store averages for each position
average_bid <- matrix(NA, nrow = 100, ncol = 10)
average_ask <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  Bids_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 4])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  Asks_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 5])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    Bids <- sapply(Bids_set6, function(x) as.numeric(x[i]))
    Asks <- sapply(Asks_set6, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_bid[i, n] <- mean(Bids, na.rm = TRUE)
    average_ask[i, n] <- mean(Asks, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_bid <- rowMeans(average_bid, na.rm = TRUE)
overall_average_ask <- rowMeans(average_ask, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_bid, type = "l", pch = 16, col = "blue", main = "Overall Average of Bids vs Asks", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_bid, overall_average_ask)), max(c(overall_average_bid, overall_average_ask))))
lines(overall_average_ask, type = "l", pch = 16, col = "red")
legend("topright", legend = c("Bids", "Asks"), col = c("blue", "red"), lty = 1, cex = 0.8)
```


```{r}
# Initialize matrices to store averages for each position
average_MM_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy3_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy4_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy5_pnl <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pnl_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 6])), ", ")

  Informed_pnl_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 8])), ", ")
  
  Noisy1_pnl_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 10])), ", ")
  
  Noisy2_pnl_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 12])), ", ")
  
  Noisy3_pnl_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 14])), ", ")
  
  Noisy4_pnl_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 16])), ", ")
  
  Noisy5_pnl_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 18])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pnl <- sapply(MM_pnl_set6, function(x) as.numeric(x[i]))
    Informed_pnl <- sapply(Informed_pnl_set6, function(x) as.numeric(x[i]))
    Noisy1_pnl <- sapply(Noisy1_pnl_set6, function(x) as.numeric(x[i]))
    Noisy2_pnl <- sapply(Noisy2_pnl_set6, function(x) as.numeric(x[i]))
    Noisy3_pnl <- sapply(Noisy3_pnl_set6, function(x) as.numeric(x[i]))
    Noisy4_pnl <- sapply(Noisy4_pnl_set6, function(x) as.numeric(x[i]))
    Noisy5_pnl <- sapply(Noisy5_pnl_set6, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pnl[i, n] <- mean(MM_pnl, na.rm = TRUE)
    average_Informed_pnl[i, n] <- mean(Informed_pnl, na.rm = TRUE)
    average_Noisy1_pnl[i, n] <- mean(Noisy1_pnl, na.rm = TRUE)
    average_Noisy2_pnl[i, n] <- mean(Noisy2_pnl, na.rm = TRUE)
    average_Noisy3_pnl[i, n] <- mean(Noisy3_pnl, na.rm = TRUE)
    average_Noisy4_pnl[i, n] <- mean(Noisy4_pnl, na.rm = TRUE)
    average_Noisy5_pnl[i, n] <- mean(Noisy5_pnl, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pnl <- rowMeans(average_MM_pnl, na.rm = TRUE)
overall_average_Informed_pnl <- rowMeans(average_Informed_pnl, na.rm = TRUE)
overall_average_Noisy1_pnl <- rowMeans(average_Noisy1_pnl, na.rm = TRUE)
overall_average_Noisy2_pnl <- rowMeans(average_Noisy2_pnl, na.rm = TRUE)
overall_average_Noisy3_pnl <- rowMeans(average_Noisy3_pnl, na.rm = TRUE)
overall_average_Noisy4_pnl <- rowMeans(average_Noisy4_pnl, na.rm = TRUE)
overall_average_Noisy5_pnl <- rowMeans(average_Noisy5_pnl, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pnl, type = "l", pch = 16, col = "black", main = "Overall Average PNL", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pnl, overall_average_Informed_pnl, overall_average_Noisy1_pnl, overall_average_Noisy2_pnl, overall_average_Noisy3_pnl, overall_average_Noisy4_pnl, overall_average_Noisy5_pnl)), max(c(overall_average_MM_pnl, overall_average_Informed_pnl, overall_average_Noisy1_pnl, overall_average_Noisy2_pnl, overall_average_Noisy3_pnl, overall_average_Noisy4_pnl, overall_average_Noisy5_pnl))))
lines(overall_average_Informed_pnl, type = "l", pch = 16, col = "red")
lines(overall_average_Noisy1_pnl, type = "l", pch = 16, col = "green")
lines(overall_average_Noisy2_pnl, type = "l", pch = 16, col = "yellow")
lines(overall_average_Noisy3_pnl, type = "l", pch = 16, col = "blue")
lines(overall_average_Noisy4_pnl, type = "l", pch = 16, col = "purple")
lines(overall_average_Noisy5_pnl, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed", "Noisy 1", "Noisy 2", "Noisy 3", "Noisy 4", "Noisy 5"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```


```{r}
# Initialize matrices to store averages for each position
average_MM_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Informed_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy1_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy2_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy3_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy4_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy5_pos <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pos_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 7])), ", ")

  Informed_pos_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 9])), ", ")
  
  Noisy1_pos_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 11])), ", ")
  
  Noisy2_pos_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 13])), ", ")
  
  Noisy3_pos_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 15])), ", ")
  
  Noisy4_pos_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 17])), ", ")
  
  Noisy5_pos_set6 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_6[n, 19])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pos <- sapply(MM_pos_set6, function(x) as.numeric(x[i]))
    Informed_pos <- sapply(Informed_pnl_set6, function(x) as.numeric(x[i]))
    Noisy1_pos <- sapply(Noisy1_pos_set6, function(x) as.numeric(x[i]))
    Noisy2_pos <- sapply(Noisy2_pos_set6, function(x) as.numeric(x[i]))
    Noisy3_pos <- sapply(Noisy3_pos_set6, function(x) as.numeric(x[i]))
    Noisy4_pos <- sapply(Noisy4_pos_set6, function(x) as.numeric(x[i]))
    Noisy5_pos <- sapply(Noisy5_pos_set6, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pos[i, n] <- mean(MM_pos, na.rm = TRUE)
    average_Informed_pos[i, n] <- mean(Informed_pos, na.rm = TRUE)
    average_Noisy1_pos[i, n] <- mean(Noisy1_pos, na.rm = TRUE)
    average_Noisy2_pos[i, n] <- mean(Noisy2_pos, na.rm = TRUE)
    average_Noisy3_pos[i, n] <- mean(Noisy3_pos, na.rm = TRUE)
    average_Noisy4_pos[i, n] <- mean(Noisy4_pos, na.rm = TRUE)
    average_Noisy5_pos[i, n] <- mean(Noisy5_pos, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pos <- rowMeans(average_MM_pos, na.rm = TRUE)
overall_average_Informed_pos <- rowMeans(average_Informed_pos, na.rm = TRUE)
overall_average_Noisy1_pos <- rowMeans(average_Noisy1_pos, na.rm = TRUE)
overall_average_Noisy2_pos <- rowMeans(average_Noisy2_pos, na.rm = TRUE)
overall_average_Noisy3_pos <- rowMeans(average_Noisy3_pos, na.rm = TRUE)
overall_average_Noisy4_pos <- rowMeans(average_Noisy4_pos, na.rm = TRUE)
overall_average_Noisy5_pos <- rowMeans(average_Noisy5_pos, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pos, type = "l", pch = 16, col = "black", main = "Overall Average Position", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pos, overall_average_Informed_pos, overall_average_Noisy1_pos, overall_average_Noisy2_pos, overall_average_Noisy3_pos, overall_average_Noisy4_pos, overall_average_Noisy5_pos)), max(c(overall_average_MM_pos, overall_average_Informed_pos, overall_average_Noisy1_pos, overall_average_Noisy2_pos, overall_average_Noisy3_pos, overall_average_Noisy4_pos, overall_average_Noisy5_pos))))
lines(overall_average_Informed_pos, type = "l", pch = 16, col = "red")
lines(overall_average_Noisy1_pos, type = "l", pch = 16, col = "green")
lines(overall_average_Noisy2_pos, type = "l", pch = 16, col = "yellow")
lines(overall_average_Noisy3_pos, type = "l", pch = 16, col = "blue")
lines(overall_average_Noisy4_pos, type = "l", pch = 16, col = "purple")
lines(overall_average_Noisy5_pos, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed", "Noisy 1", "Noisy 2", "Noisy 3", "Noisy 4", "Noisy 5"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```


## set7 (1 informed + 5 noisy informed)

```{r}
# Initialize matrices to store averages for each position
average_true <- matrix(NA, nrow = 100, ncol = 10)
average_expected <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  TrueValues_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 2])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  ExpectedValues_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 3])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    True_values <- sapply(TrueValues_set7, function(x) as.numeric(x[i]))
    Expected_values <- sapply(ExpectedValues_set6, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_true[i, n] <- mean(True_values, na.rm = TRUE)
    average_expected[i, n] <- mean(Expected_values, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_true <- rowMeans(average_true, na.rm = TRUE)
overall_average_expected <- rowMeans(average_expected, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_true, type = "l", pch = 16, col = "blue", main = "Overall Average of True vs Expected Values", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_true, overall_average_expected)), max(c(overall_average_true, overall_average_expected))))
lines(overall_average_expected, type = "l", pch = 16, col = "red")
legend("topright", legend = c("True Values", "Expected Values"), col = c("blue", "red"), lty = 1, cex = 0.8)
```


```{r}
# Initialize matrices to store averages for each position
average_bid <- matrix(NA, nrow = 100, ncol = 10)
average_ask <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  Bids_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 4])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  Asks_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 5])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    Bids <- sapply(Bids_set7, function(x) as.numeric(x[i]))
    Asks <- sapply(Asks_set7, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_bid[i, n] <- mean(Bids, na.rm = TRUE)
    average_ask[i, n] <- mean(Asks, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_bid <- rowMeans(average_bid, na.rm = TRUE)
overall_average_ask <- rowMeans(average_ask, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_bid, type = "l", pch = 16, col = "blue", main = "Overall Average of Bids vs Asks", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_bid, overall_average_ask)), max(c(overall_average_bid, overall_average_ask))))
lines(overall_average_ask, type = "l", pch = 16, col = "red")
legend("topright", legend = c("Bids", "Asks"), col = c("blue", "red"), lty = 1, cex = 0.8)
```


```{r}
# Initialize matrices to store averages for each position
average_MM_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed3_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed4_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed5_pnl <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pnl_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 6])), ", ")

  Informed_pnl_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 8])), ", ")
  
  NoisyInformed1_pnl_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 10])), ", ")
  
  NoisyInformed2_pnl_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 12])), ", ")
  
  NoisyInformed3_pnl_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 14])), ", ")
  
  NoisyInformed4_pnl_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 16])), ", ")
  
  NoisyInformed5_pnl_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 18])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pnl <- sapply(MM_pnl_set7, function(x) as.numeric(x[i]))
    Informed_pnl <- sapply(Informed_pnl_set7, function(x) as.numeric(x[i]))
    NoisyInformed1_pnl <- sapply(NoisyInformed1_pnl_set7, function(x) as.numeric(x[i]))
    NoisyInformed2_pnl <- sapply(NoisyInformed2_pnl_set7, function(x) as.numeric(x[i]))
    NoisyInformed3_pnl <- sapply(NoisyInformed3_pnl_set7, function(x) as.numeric(x[i]))
    NoisyInformed4_pnl <- sapply(NoisyInformed4_pnl_set7, function(x) as.numeric(x[i]))
    NoisyInformed5_pnl <- sapply(NoisyInformed5_pnl_set7, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pnl[i, n] <- mean(MM_pnl, na.rm = TRUE)
    average_Informed_pnl[i, n] <- mean(Informed_pnl, na.rm = TRUE)
    average_NoisyInformed1_pnl[i, n] <- mean(NoisyInformed1_pnl, na.rm = TRUE)
    average_NoisyInformed2_pnl[i, n] <- mean(NoisyInformed2_pnl, na.rm = TRUE)
    average_NoisyInformed3_pnl[i, n] <- mean(NoisyInformed3_pnl, na.rm = TRUE)
    average_NoisyInformed4_pnl[i, n] <- mean(NoisyInformed4_pnl, na.rm = TRUE)
    average_NoisyInformed5_pnl[i, n] <- mean(NoisyInformed5_pnl, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pnl <- rowMeans(average_MM_pnl, na.rm = TRUE)
overall_average_Informed_pnl <- rowMeans(average_Informed_pnl, na.rm = TRUE)
overall_average_NoisyInformed1_pnl <- rowMeans(average_NoisyInformed1_pnl, na.rm = TRUE)
overall_average_NoisyInformed2_pnl <- rowMeans(average_NoisyInformed2_pnl, na.rm = TRUE)
overall_average_NoisyInformed3_pnl <- rowMeans(average_NoisyInformed3_pnl, na.rm = TRUE)
overall_average_NoisyInformed4_pnl <- rowMeans(average_NoisyInformed4_pnl, na.rm = TRUE)
overall_average_NoisyInformed5_pnl <- rowMeans(average_NoisyInformed5_pnl, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pnl, type = "l", pch = 16, col = "black", main = "Overall Average PNL", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pnl, overall_average_Informed_pnl, overall_average_NoisyInformed1_pnl, overall_average_NoisyInformed2_pnl, overall_average_NoisyInformed3_pnl, overall_average_NoisyInformed4_pnl, overall_average_NoisyInformed5_pnl)), max(c(overall_average_MM_pnl, overall_average_Informed_pnl, overall_average_NoisyInformed1_pnl, overall_average_NoisyInformed2_pnl, overall_average_NoisyInformed3_pnl, overall_average_NoisyInformed4_pnl, overall_average_NoisyInformed5_pnl))))
lines(overall_average_Informed_pnl, type = "l", pch = 16, col = "red")
lines(overall_average_NoisyInformed1_pnl, type = "l", pch = 16, col = "green")
lines(overall_average_NoisyInformed2_pnl, type = "l", pch = 16, col = "yellow")
lines(overall_average_NoisyInformed3_pnl, type = "l", pch = 16, col = "blue")
lines(overall_average_NoisyInformed4_pnl, type = "l", pch = 16, col = "purple")
lines(overall_average_NoisyInformed5_pnl, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed", "Noisy Informed 1", "Noisy Informed 2", "Noisy Informed 3", "Noisy Informed 4", "Noisy Informed 5"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```

```{r}
# Initialize matrices to store averages for each position
average_MM_pos <- matrix(NA, nrow = 100, ncol = 10)
average_Informed_pos <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed1_pos <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed2_pos <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed3_pos <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed4_pos <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed5_pos <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pos_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 7])), ", ")

  Informed_pos_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 9])), ", ")
  
  NoisyInformed1_pos_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 11])), ", ")
  
  NoisyInformed2_pos_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 13])), ", ")
  
  NoisyInformed3_pos_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 15])), ", ")
  
  NoisyInformed4_pos_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 17])), ", ")
  
  NoisyInformed5_pos_set7 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_7[n, 19])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pos <- sapply(MM_pos_set7, function(x) as.numeric(x[i]))
    Informed_pos <- sapply(Informed_pos_set7, function(x) as.numeric(x[i]))
    NoisyInformed1_pos <- sapply(NoisyInformed1_pos_set7, function(x) as.numeric(x[i]))
    NoisyInformed2_pos <- sapply(NoisyInformed2_pos_set7, function(x) as.numeric(x[i]))
    NoisyInformed3_pos <- sapply(NoisyInformed3_pos_set7, function(x) as.numeric(x[i]))
    NoisyInformed4_pos <- sapply(NoisyInformed4_pos_set7, function(x) as.numeric(x[i]))
    NoisyInformed5_pos <- sapply(NoisyInformed5_pos_set7, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pos[i, n] <- mean(MM_pos, na.rm = TRUE)
    average_Informed_pos[i, n] <- mean(Informed_pos, na.rm = TRUE)
    average_NoisyInformed1_pos[i, n] <- mean(NoisyInformed1_pos, na.rm = TRUE)
    average_NoisyInformed2_pos[i, n] <- mean(NoisyInformed2_pos, na.rm = TRUE)
    average_NoisyInformed3_pos[i, n] <- mean(NoisyInformed3_pos, na.rm = TRUE)
    average_NoisyInformed4_pos[i, n] <- mean(NoisyInformed4_pos, na.rm = TRUE)
    average_NoisyInformed5_pos[i, n] <- mean(NoisyInformed5_pos, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pos <- rowMeans(average_MM_pos, na.rm = TRUE)
overall_average_Informed_pos <- rowMeans(average_Informed_pos, na.rm = TRUE)
overall_average_NoisyInformed1_pos <- rowMeans(average_NoisyInformed1_pos, na.rm = TRUE)
overall_average_NoisyInformed2_pos <- rowMeans(average_NoisyInformed2_pos, na.rm = TRUE)
overall_average_NoisyInformed3_pos <- rowMeans(average_NoisyInformed3_pos, na.rm = TRUE)
overall_average_NoisyInformed4_pos <- rowMeans(average_NoisyInformed4_pos, na.rm = TRUE)
overall_average_NoisyInformed5_pos <- rowMeans(average_NoisyInformed5_pos, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pos, type = "l", pch = 16, col = "black", main = "Overall Average Position", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pos, overall_average_Informed_pos, overall_average_NoisyInformed1_pos, overall_average_NoisyInformed2_pos, overall_average_NoisyInformed3_pos, overall_average_NoisyInformed4_pos, overall_average_NoisyInformed5_pos)), max(c(overall_average_MM_pos, overall_average_Informed_pos, overall_average_NoisyInformed1_pos, overall_average_NoisyInformed2_pos, overall_average_NoisyInformed3_pos, overall_average_NoisyInformed4_pos, overall_average_NoisyInformed5_pos))))
lines(overall_average_Informed_pos, type = "l", pch = 16, col = "red")
lines(overall_average_NoisyInformed1_pos, type = "l", pch = 16, col = "green")
lines(overall_average_NoisyInformed2_pos, type = "l", pch = 16, col = "yellow")
lines(overall_average_NoisyInformed3_pos, type = "l", pch = 16, col = "blue")
lines(overall_average_NoisyInformed4_pos, type = "l", pch = 16, col = "purple")
lines(overall_average_NoisyInformed5_pos, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed", "Noisy Informed 1", "Noisy Informed 2", "Noisy Informed 3", "Noisy Informed 4", "Noisy Informed 5"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```



## set8 (1 informed + 2 noisy informed + 3 noisy)

```{r}
# Initialize matrices to store averages for each position
average_true <- matrix(NA, nrow = 100, ncol = 10)
average_expected <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  TrueValues_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 2])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  ExpectedValues_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 3])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    True_values <- sapply(TrueValues_set7, function(x) as.numeric(x[i]))
    Expected_values <- sapply(ExpectedValues_set6, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_true[i, n] <- mean(True_values, na.rm = TRUE)
    average_expected[i, n] <- mean(Expected_values, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_true <- rowMeans(average_true, na.rm = TRUE)
overall_average_expected <- rowMeans(average_expected, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_true, type = "l", pch = 16, col = "blue", main = "Overall Average of True vs Expected Values", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_true, overall_average_expected)), max(c(overall_average_true, overall_average_expected))))
lines(overall_average_expected, type = "l", pch = 16, col = "red")
legend("topright", legend = c("True Values", "Expected Values"), col = c("blue", "red"), lty = 1, cex = 0.8)
```

```{r}
# Initialize matrices to store averages for each position
average_bid <- matrix(NA, nrow = 100, ncol = 10)
average_ask <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {
  # Extract True values from the aggregated_results_4 dataframe
  Bids_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 4])), ", ")
  
  # Extract Expected values from the aggregated_results_4 dataframe
  Asks_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 5])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    Bids <- sapply(Bids_set8, function(x) as.numeric(x[i]))
    Asks <- sapply(Asks_set8, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_bid[i, n] <- mean(Bids, na.rm = TRUE)
    average_ask[i, n] <- mean(Asks, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_bid <- rowMeans(average_bid, na.rm = TRUE)
overall_average_ask <- rowMeans(average_ask, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_bid, type = "l", pch = 16, col = "blue", main = "Overall Average of Bids vs Asks", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_bid, overall_average_ask)), max(c(overall_average_bid, overall_average_ask))))
lines(overall_average_ask, type = "l", pch = 16, col = "red")
legend("topright", legend = c("Bids", "Asks"), col = c("blue", "red"), lty = 1, cex = 0.8)
```

```{r}
# Initialize matrices to store averages for each position
average_MM_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy3_pnl <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pnl_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 6])), ", ")

  Informed_pnl_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 8])), ", ")
  
  NoisyInformed1_pnl_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 10])), ", ")
  
  NoisyInformed2_pnl_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 12])), ", ")
  
  Noisy1_pnl_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 14])), ", ")
  
  Noisy2_pnl_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 16])), ", ")
  
  Noisy3_pnl_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 18])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pnl <- sapply(MM_pnl_set8, function(x) as.numeric(x[i]))
    Informed_pnl <- sapply(Informed_pnl_set8, function(x) as.numeric(x[i]))
    NoisyInformed1_pnl <- sapply(NoisyInformed1_pnl_set8, function(x) as.numeric(x[i]))
    NoisyInformed2_pnl <- sapply(NoisyInformed2_pnl_set8, function(x) as.numeric(x[i]))
    Noisy1_pnl <- sapply(Noisy1_pnl_set8, function(x) as.numeric(x[i]))
    Noisy2_pnl <- sapply(Noisy2_pnl_set8, function(x) as.numeric(x[i]))
    Noisy3_pnl <- sapply(Noisy3_pnl_set8, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pnl[i, n] <- mean(MM_pnl, na.rm = TRUE)
    average_Informed_pnl[i, n] <- mean(Informed_pnl, na.rm = TRUE)
    average_NoisyInformed1_pnl[i, n] <- mean(NoisyInformed1_pnl, na.rm = TRUE)
    average_NoisyInformed2_pnl[i, n] <- mean(NoisyInformed2_pnl, na.rm = TRUE)
    average_Noisy1_pnl[i, n] <- mean(Noisy1_pnl, na.rm = TRUE)
    average_Noisy2_pnl[i, n] <- mean(Noisy2_pnl, na.rm = TRUE)
    average_Noisy3_pnl[i, n] <- mean(Noisy3_pnl, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pnl <- rowMeans(average_MM_pnl, na.rm = TRUE)
overall_average_Informed_pnl <- rowMeans(average_Informed_pnl, na.rm = TRUE)
overall_average_NoisyInformed1_pnl <- rowMeans(average_NoisyInformed1_pnl, na.rm = TRUE)
overall_average_NoisyInformed2_pnl <- rowMeans(average_NoisyInformed2_pnl, na.rm = TRUE)
overall_average_Noisy1_pnl <- rowMeans(average_Noisy1_pnl, na.rm = TRUE)
overall_average_Noisy2_pnl <- rowMeans(average_Noisy2_pnl, na.rm = TRUE)
overall_average_Noisy3_pnl <- rowMeans(average_Noisy3_pnl, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pnl, type = "l", pch = 16, col = "black", main = "Overall Average PNL", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pnl, overall_average_Informed_pnl, overall_average_NoisyInformed1_pnl, overall_average_NoisyInformed2_pnl, overall_average_Noisy1_pnl, overall_average_Noisy2_pnl, overall_average_Noisy3_pnl)), max(c(overall_average_MM_pnl, overall_average_Informed_pnl, overall_average_NoisyInformed1_pnl, overall_average_NoisyInformed2_pnl, overall_average_Noisy1_pnl, overall_average_Noisy2_pnl, overall_average_Noisy3_pnl))))
lines(overall_average_Informed_pnl, type = "l", pch = 16, col = "red")
lines(overall_average_NoisyInformed1_pnl, type = "l", pch = 16, col = "green")
lines(overall_average_NoisyInformed2_pnl, type = "l", pch = 16, col = "yellow")
lines(overall_average_Noisy1_pnl, type = "l", pch = 16, col = "blue")
lines(overall_average_Noisy2_pnl, type = "l", pch = 16, col = "purple")
lines(overall_average_Noisy3_pnl, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed", "Noisy Informed 1", "Noisy Informed 2", "Noisy 3", "Noisy 4", "Noisy 5"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```

```{r}
# Initialize matrices to store averages for each position
average_MM_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Informed_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_NoisyInformed2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy1_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy2_pnl <- matrix(NA, nrow = 100, ncol = 10)
average_Noisy3_pnl <- matrix(NA, nrow = 100, ncol = 10)

# Loop through each simulation (n)
for (n in 1:10) {

  MM_pos_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 7])), ", ")

  Informed_pos_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 9])), ", ")
  
  NoisyInformed1_pos_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 11])), ", ")
  
  NoisyInformed2_pos_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 13])), ", ")
  
  Noisy1_pos_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 15])), ", ")
  
  Noisy2_pos_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 17])), ", ")
  
  Noisy3_pos_set8 <- strsplit(gsub("\\[|\\]", "", unlist(aggregated_results_8[n, 19])), ", ")
  
  # Loop through each position (i)
  for (i in 1:100) {
    # Extract True and Expected values for the i-th position
    MM_pos <- sapply(MM_pos_set8, function(x) as.numeric(x[i]))
    Informed_pos <- sapply(Informed_pos_set8, function(x) as.numeric(x[i]))
    NoisyInformed1_pos <- sapply(NoisyInformed1_pos_set8, function(x) as.numeric(x[i]))
    NoisyInformed2_pos <- sapply(NoisyInformed2_pos_set8, function(x) as.numeric(x[i]))
    Noisy1_pos <- sapply(Noisy1_pos_set8, function(x) as.numeric(x[i]))
    Noisy2_pos <- sapply(Noisy2_pos_set8, function(x) as.numeric(x[i]))
    Noisy3_pos <- sapply(Noisy3_pos_set8, function(x) as.numeric(x[i]))
    
    # Calculate the average of True and Expected values for the i-th position
    average_MM_pos[i, n] <- mean(MM_pos, na.rm = TRUE)
    average_Informed_pos[i, n] <- mean(Informed_pos, na.rm = TRUE)
    average_NoisyInformed1_pos[i, n] <- mean(NoisyInformed1_pos, na.rm = TRUE)
    average_NoisyInformed2_pos[i, n] <- mean(NoisyInformed2_pos, na.rm = TRUE)
    average_Noisy1_pos[i, n] <- mean(Noisy1_pos, na.rm = TRUE)
    average_Noisy2_pos[i, n] <- mean(Noisy2_pos, na.rm = TRUE)
    average_Noisy3_pos[i, n] <- mean(Noisy3_pos, na.rm = TRUE)
  }
}

# Calculate the overall average for each position across all simulations
overall_average_MM_pos <- rowMeans(average_MM_pos, na.rm = TRUE)
overall_average_Informed_pos <- rowMeans(average_Informed_pos, na.rm = TRUE)
overall_average_NoisyInformed1_pos <- rowMeans(average_NoisyInformed1_pos, na.rm = TRUE)
overall_average_NoisyInformed2_pos <- rowMeans(average_NoisyInformed2_pos, na.rm = TRUE)
overall_average_Noisy1_pos <- rowMeans(average_Noisy1_pos, na.rm = TRUE)
overall_average_Noisy2_pos <- rowMeans(average_Noisy2_pos, na.rm = TRUE)
overall_average_Noisy3_pos <- rowMeans(average_Noisy3_pos, na.rm = TRUE)

# Plot the overall averages
plot(overall_average_MM_pos, type = "l", pch = 16, col = "black", main = "Overall Average Position", xlab = "Position in List", ylab = "Value", ylim = c(min(c(overall_average_MM_pos, overall_average_Informed_pos, overall_average_NoisyInformed1_pos, overall_average_NoisyInformed2_pos, overall_average_Noisy1_pos, overall_average_Noisy2_pos, overall_average_Noisy3_pos)), max(c(overall_average_MM_pos, overall_average_Informed_pos, overall_average_NoisyInformed1_pos, overall_average_NoisyInformed2_pos, overall_average_Noisy1_pos, overall_average_Noisy2_pos, overall_average_Noisy3_pos))))
lines(overall_average_Informed_pos, type = "l", pch = 16, col = "red")
lines(overall_average_NoisyInformed1_pos, type = "l", pch = 16, col = "green")
lines(overall_average_NoisyInformed2_pos, type = "l", pch = 16, col = "yellow")
lines(overall_average_Noisy1_pos, type = "l", pch = 16, col = "blue")
lines(overall_average_Noisy2_pos, type = "l", pch = 16, col = "purple")
lines(overall_average_Noisy3_pos, type = "l", pch = 16, col = "orange")

# Add legend
legend("bottomleft", legend = c("Market Maker", "Informed", "Noisy Informed 1", "Noisy Informed 2", "Noisy 3", "Noisy 4", "Noisy 5"), col = c("black", "red", "green", "yellow", "blue", "purple", "orange"), lty = 1, cex = 0.8)
```


## set9



## set10



## set11



## set12



## set13



## set14



## set15







